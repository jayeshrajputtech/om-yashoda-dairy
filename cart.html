<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Review your shopping cart and proceed to checkout.">
    <title>Shopping Cart - OM Yashoda Dairy</title>

    <link rel="icon" type="image/svg+xml"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ¥›</text></svg>">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="/css/variables.css">
    <link rel="stylesheet" href="/css/reset.css">
    <link rel="stylesheet" href="/css/global.css">
    <link rel="stylesheet" href="/css/components.css">
    <link rel="stylesheet" href="/css/pages.css">
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="container header-container">
            <a href="/" class="logo">
                <span class="logo-icon">ðŸ¥›</span>
                <span>OM Yashoda Dairy</span>
            </a>

            <nav class="nav-menu">
                <a href="/" class="nav-link">Home</a>
                <a href="/products.html" class="nav-link">Products</a>
                <a href="/#about" class="nav-link">About</a>
                <a href="/#contact" class="nav-link">Contact</a>
            </nav>

            <div class="nav-actions">
                <button id="auth-btn" class="btn btn-outline btn-sm">Login</button>
                <a href="/cart.html" class="cart-icon-wrapper">
                    <svg class="cart-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path
                            d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2 9m2-9h10m0 0l2 9m-2-9v9m-10 0a1 1 0 100 2 1 1 0 000-2zm10 0a1 1 0 100 2 1 1 0 000-2z" />
                    </svg>
                    <span class="cart-badge" style="display: none;">0</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Cart Section -->
    <section class="section">
        <div class="container">
            <h1 class="mb-8">Shopping Cart</h1>

            <div class="cart-layout">
                <!-- Cart Items -->
                <div>
                    <div id="cart-items-container">
                        <!-- Cart items will be loaded here -->
                    </div>
                </div>

                <!-- Cart Summary -->
                <div>
                    <div class="cart-summary">
                        <h3 style="margin-bottom: var(--spacing-4);">Order Summary</h3>

                        <div id="cart-summary">
                            <!-- Summary will be loaded here -->
                        </div>

                        <button id="checkout-btn" class="btn btn-primary"
                            style="width: 100%; margin-top: var(--spacing-4);">
                            Proceed to Checkout
                        </button>

                        <a href="/products.html" class="btn btn-outline"
                            style="width: 100%; margin-top: var(--spacing-3);">
                            Continue Shopping
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>OM Yashoda Dairy</h3>
                    <p>Your trusted source for fresh, pure dairy products in Kalyan West.</p>
                </div>

                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <div class="footer-links">
                        <a href="/">Home</a>
                        <a href="/products.html">Products</a>
                        <a href="/cart.html">Cart</a>
                    </div>
                </div>

                <div class="footer-section">
                    <h3>Contact</h3>
                    <div class="footer-links">
                        <a href="tel:+919320056114">+91 9320056114</a>
                        <p>Kalyan West, Maharashtra</p>
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2026 OM Yashoda Dairy. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script type="module">
        import { CONFIG } from '/js/config.js';
        import { AuthService } from '/js/firebase-config.js';
        import {
            renderCartItems,
            renderCartSummary,
            initCartEventListeners,
            updateCartBadge,
            validateCart,
            getCart
        } from '/js/cart.js';
        import { showToast, updateLastActivity } from '/js/utils.js';

        // Update cart badge
        updateCartBadge();
        updateLastActivity();

        // Load cart
        async function loadCart() {
            await renderCartItems('cart-items-container', 'en');
            await renderCartSummary('cart-summary');
        }

        // Initialize cart event listeners
        initCartEventListeners();

        // Handle checkout button
        document.getElementById('checkout-btn').addEventListener('click', async () => {
            const cart = getCart();

            if (cart.length === 0) {
                showToast('Your cart is empty', 'error');
                return;
            }

            // Validate cart
            const validation = await validateCart();
            if (!validation.isValid) {
                validation.errors.forEach(error => showToast(error, 'error'));
                return;
            }

            // Redirect to checkout
            window.location.href = '/checkout.html';
        });

        // Auth button handler
        const authBtn = document.getElementById('auth-btn');

        AuthService.onAuthChange((user) => {
            if (user) {
                authBtn.textContent = user.displayName || 'Account';
                authBtn.classList.remove('btn-outline');
                authBtn.classList.add('btn-primary');
            } else {
                authBtn.textContent = 'Login';
                authBtn.classList.remove('btn-primary');
                authBtn.classList.add('btn-outline');
            }
        });

        authBtn.addEventListener('click', () => {
            const user = AuthService.getCurrentUser();
            if (user) {
                if (confirm('Do you want to logout?')) {
                    AuthService.logout();
                    showToast('Logged out successfully', 'info');
                }
            } else {
                window.location.href = '/checkout.html';
            }
        });

        // Initialize
        loadCart();
    </script>
</body>

</html>